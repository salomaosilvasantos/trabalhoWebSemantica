@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix tse: <http://arida.ufc.br/tse/> .
@prefix map: <#> .
@prefix map: <http://example/> .
@prefix vocab: <http://rdf.ontology2.com/vocab#> .

@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix conf: <http://ufc.arida.br/conf/> .
@prefix vcard: <http://www.w3.org/TR/vcard-rdf/> .
@prefix dc: <http://dublincore.org/documents/dc-rdf/> .
@prefix dcterms: <http://dublincore.org/documents/dcmi-terms/> .
@prefix dbo: <http://dbpedia.org/ontology/>.
@prefix dbr: <http://dbpedia.org/resource/>.
@prefix time: <http://www.w3.org/TR/owl-time/>.


map:Person a rr:TriplesMap;
    rr:logicalTable [
            rr:sqlQuery """SELECT * from pessoa_tse_view""" ];
    rr:subjectMap [
        rr:template "http://arida.ufc.br/tse/RestringidoPessoa/{ID}/";
        rr:class foaf:Person;
    ];
    rr:predicateObjectMap [
        rr:predicate foaf:name;
        rr:objectMap [
            rr:template "{Nome}";
            rr:termType rr:Literal;
        ];
    ];
  	rr:predicateObjectMap [
        rr:predicate dbr:cpf;
        rr:objectMap [
            rr:template "{CPF}";
            rr:termType rr:Literal;
        ];
      ];
    rr:predicateObjectMap [
        rr:predicate rdf:id;
        rr:objectMap [
            rr:template "{id}";
            rr:termType rr:Literal;
        ];
    ];
.

#mapeando retricao
map:Restricao a rr:TriplesMap;
    rr:logicalTable [
            rr:sqlQuery """SELECT * from restricao_tse_view""" ];
    rr:subjectMap [
        rr:template "http://arida.ufc.br/tse/Restricao/{rid}/";
        rr:class foaf:Restricao;
    ];
    rr:predicateObjectMap [
        rr:predicate rdf:id;
        rr:objectMap [
            rr:template "{rid}";
            rr:termType rr:Literal;
        ];
    ];
	  rr:predicateObjectMap [
		    rr:predicate vocab:numProcess;
		    rr:objectMap [
		        rr:template "{numProcess}";
		        rr:termType rr:Literal;
		    ];
	  ];
	  rr:predicateObjectMap [
    		rr:predicate time:date;
    		rr:objectMap [
		        rr:template "{date}";
		        rr:termType rr:Literal;
		    ];
	  ];
.

#relacao entre as tabela pessoa e restricao
   map:Person_tem_restricao
	       rr:logicalTable [ rr:sqlQuery """
                 SELECT p.id as id_pessoa, r.rid as id_restricao
		             FROM pessoa_tse_view p, restricao_tse_view r
		             WHERE p.id= r.pessoa_id
	       """ ];
	       rr:subjectMap [
		            rr:template 'http://arida.ufc.br/tse/RestringidoPessoa/{"id_pessoa"}';
		            rr:class foaf:Person;
	       ];
	       rr:predicateObjectMap [
		            rr:predicate tse:temRestricao;
		            rr:objectMap [
			                rr:parentTriplesMap map:Restricao;
			                rr:joinCondition[
				                     rr:child 'id_restricao';
				                     rr:parent 'rid';
			                ]
		           ]
	      ].

#mapeando tabela provenance

 map:Provenance a rr:TriplesMap;
    rr:logicalTable [
            rr:sqlQuery """SELECT * from provenance""" ];
    rr:subjectMap [
        rr:template "http://arida.ufc.br/tse/Provenance/{id}/";
        rr:class vocab:Provenance;
    ];
  	rr:predicateObjectMap [
          rr:predicate rdfs:label;
          rr:objectMap [
              rr:template "{label}";
              rr:termType rr:Literal;
          ];
    ];
  	rr:predicateObjectMap [
          rr:predicate dbr:fileName;
          rr:objectMap [
              rr:template "{filename}";
              rr:termType rr:Literal;
          ];
    ];
  	rr:predicateObjectMap [
          rr:predicate time:date;
          rr:objectMap [
              rr:template "{date}";
              rr:termType rr:Literal;
          ];
    ];
  	rr:predicateObjectMap [
          rr:predicate dc:source;
          rr:objectMap [
              rr:template "{source}";
              rr:termType rr:Literal;
          ];
    ];
  	rr:predicateObjectMap [
          rr:predicate vocab:complement;
          rr:objectMap [
              rr:template "{complement}";
              rr:termType rr:Literal;
          ];
    ];
.

#relacao entre as tabela restricao e provenance
   map:Restritor_tem_provenance
	      rr:logicalTable [ rr:sqlQuery """
              SELECT r.rid as id_restricao, p.id as id_provenance
		          FROM restricao_tse_view r, provenance p
		          WHERE r.provenance_id= p.id
	      """ ];
	      rr:subjectMap [
		           rr:template 'http://arida.ufc.br/tse/restricao/{"id_restricao"}';
		           rr:class tse:Restricao;
	      ];
	      rr:predicateObjectMap [
		          rr:predicate tse:temProvenance;
		          rr:objectMap [
			               rr:parentTriplesMap map:Provenance;
			               rr:joinCondition[
				                     rr:child 'id_provenance';
				                     rr:parent 'id';
			               ]
		         ]
	      ].

#Mapeamento table Restritor
    map:Restritor a rr:TriplesMap;
        rr:logicalTable [
                rr:sqlQuery """SELECT * from restritor""" ];
        rr:subjectMap [
              rr:template "http://arida.ufc.br/tse/Restritor/{id}/";
              rr:class tse:Restritor;
        ];
        rr:predicateObjectMap [
              rr:predicate rdf:id;
              rr:objectMap [
                     rr:template "{id}";
                     rr:termType rr:Literal;
              ];
        ];
        rr:predicateObjectMap [
              rr:predicate rdfs:label;
              rr:objectMap [
                    rr:template "{label}";
                    rr:termType rr:Literal;
              ];
        ];
  .

#relacao entre as tabela restricao e restritor
    map:restricao_tem_restritor
  	     rr:logicalTable [ rr:sqlQuery """
                  SELECT res.rid as restricao_id, r.id as restritor_id
  		            FROM restricao_tse_view res, restritor r
  		            WHERE res.restritor_id=r.id
  	     """ ];
  	     rr:subjectMap [
  		        rr:template 'http://arida.ufc.br/tse/restricao/{"restricao_id"}';
  		        rr:class tse:Restricao;
  	     ];
  	     rr:predicateObjectMap [
  		       rr:predicate tse:temRestritor;
  		       rr:objectMap [
  			          rr:parentTriplesMap map:Restritor;
  			          rr:joinCondition[
  				              rr:child 'restricao_id';
  				              rr:parent 'id';
  			          ]
  		       ]
  	     ]
.
